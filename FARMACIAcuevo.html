<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Farmacia ‚Äî Cuevo</title>
  <meta name="description" content="Farmacia Virgen de los Remedios en Cuevo. Cat√°logo con carrito, b√∫squeda, filtros, env√≠o por WhatsApp y panel simple de administraci√≥n."/>
  <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='0.9em' font-size='90'>üíä</text></svg>">

<!-- Manifest PWA -->
  <link rel="manifest" href="manifest.json">
  <meta name="theme-color" content="#22c55e" />

  <!-- Tailwind config BEFORE CDN (para extender tema) -->
  <script>
    window.tailwind = {
      theme: {
        extend: {
          colors: {
            brand: {
              50: '#ecfdf5', 100:'#d1fae5', 200:'#a7f3d0', 300:'#6ee7b7', 400:'#34d399', 500:'#22c55e', 600:'#16a34a', 700:'#15803d', 800:'#166534', 900:'#14532d'
            }
          },
          boxShadow: {
            soft: '0 10px 25px -10px rgba(34, 197, 94, .25)'
          }
        }
      }
    }
  </script>
  <!-- Tailwind CDN -->
  <script src="https://cdn.tailwindcss.com"></script>

  <!-- React 18 UMD -->
  <script defer src="https://cdn.jsdelivr.net/npm/react@18/umd/react.development.js"></script>
  <script defer src="https://cdn.jsdelivr.net/npm/react-dom@18/umd/react-dom.development.js"></script>
  <!-- Babel para JSX en el navegador -->
  <script defer src="https://cdn.jsdelivr.net/npm/@babel/standalone/babel.min.js"></script>

  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css"/>
  <style>
    /* Fuente del sistema y fondo base */
    body{font-family:Inter,system-ui,-apple-system,'Segoe UI',Roboto,Arial,sans-serif;background:#0f172a;color:#fff}
    .hero-bg{background:linear-gradient(rgba(34,197,94,.85),rgba(21,128,61,.85)),url('https://images.unsplash.com/photo-1614975470486-613b87ec6dcd?auto=format&fit=crop&w=1470&q=80');background-size:cover;background-position:center}
    .cart-drawer{transition:transform .32s cubic-bezier(.2,.8,.2,1)}
    .cart-open{transform:translateX(0%)}
    .cart-closed{transform:translateX(100%)}
    .product-img{object-fit:cover;height:11rem}
    /* Utilidad sencilla para line-clamp sin plugin */
    .line-clamp-1{display:-webkit-box;-webkit-line-clamp:1;-webkit-box-orient:vertical;overflow:hidden}
    .line-clamp-2{display:-webkit-box;-webkit-line-clamp:2;-webkit-box-orient:vertical;overflow:hidden}
    /* Respetar usuarios con motion reducido */
    @media (prefers-reduced-motion: reduce){
      *{animation-duration:0.001ms !important;animation-iteration-count:1 !important;transition-duration:0.001ms !important;scroll-behavior:auto !important}
    }
  </style>
</head>
<body>
  <noscript>
    <div style="padding:16px;margin:16px;border-radius:12px;background:#111827;color:#e5e7eb;border:1px solid #1f2937">
      Esta aplicaci√≥n requiere JavaScript. Si ves solo la pantalla azul oscuro, aseg√∫rate de tener conexi√≥n a internet
      (cargamos React/Babel/Tailwind desde CDNs) o usa un servidor local. WhatsApp: <strong>+591 71317450</strong>.
    </div>
  </noscript>

  <div id="root"></div>

  <!-- APP: usar Babel con presets para compilar JSX; esto evita "pantalla azul" por error de JSX no compilado -->
  <script type="text/babel" data-presets="env,react">
    const {useState, useEffect, useMemo, useRef} = React;

    // ---------- UTILIDADES ----------
    const PHONE_WHATSAPP = '59171317450';
    const currencyFmt = new Intl.NumberFormat('es-BO', { style:'currency', currency:'BOB', minimumFractionDigits: 2 });
    const currency = (n)=> currencyFmt.format(Number(n||0));

    // Toast muy simple
    function useToast(){
      const [msg, setMsg] = useState("");
      const [open, setOpen] = useState(false);
      const timer = useRef(null);
      const show = (text, ms=2000)=>{
        setMsg(text); setOpen(true);
        clearTimeout(timer.current);
        timer.current = setTimeout(()=> setOpen(false), ms);
      };
      return { open, msg, show };
    }

    function Toast({open, msg}){
      return (
        <div aria-live="polite" className={`fixed bottom-5 left-1/2 -translate-x-1/2 z-[60] transition ${open? 'opacity-100 translate-y-0':'opacity-0 translate-y-2 pointer-events-none'}`}>
          <div className="bg-slate-900/95 backdrop-blur border border-slate-800 text-white px-4 py-2 rounded-xl shadow-soft flex items-center gap-2">
            <i className="fas fa-check-circle text-green-400"></i>
            <span className="text-sm">{msg}</span>
          </div>
        </div>
      );
    }

    // ---------- NAVBAR ----------
    function Navbar({setPage, cartCount, onOpenCart}){
      const [open, setOpen] = useState(false);
      return (
        <nav className="bg-slate-900/90 backdrop-blur sticky top-0 z-50 border-b border-slate-800">
          <div className="max-w-7xl mx-auto px-4 flex items-center justify-between h-16">
            <div className="flex items-center gap-3">
              <button className="text-brand-400 font-bold text-xl" onClick={()=>setPage('home')} aria-label="Ir al inicio">Farmacia</button>
              <span className="hidden sm:inline text-slate-400">Virgen de los Remedios</span>
            </div>
            <div className="hidden md:flex items-center gap-6">
              <a href="#home" className="hover:text-brand-400">Inicio</a>
              <a href="#services" className="hover:text-brand-400">Servicios</a>
              <a href="#catalog" className="hover:text-brand-400">Productos</a>
              <a href="#contact" className="hover:text-brand-400">Contacto</a>
              <button onClick={()=>setPage('admin')} className="bg-brand-500 px-3 py-1 rounded-lg text-sm hover:bg-brand-600">Admin</button>
              <button onClick={onOpenCart} className="relative" aria-label="Abrir carrito">
                <i className="fas fa-shopping-cart text-xl"></i>
                {cartCount>0 && <span className="absolute -top-2 -right-2 bg-brand-500 text-xs font-bold rounded-full px-1.5 py-0.5">{cartCount}</span>}
              </button>
            </div>
            <div className="md:hidden flex items-center gap-3">
              <button onClick={onOpenCart} className="relative" aria-label="Abrir carrito">
                <i className="fas fa-shopping-cart text-xl"></i>
                {cartCount>0 && <span className="absolute -top-1 -right-2 bg-brand-500 text-[10px] font-bold rounded-full px-1">{cartCount}</span>}
              </button>
              <button onClick={()=>setOpen(v=>!v)} aria-label="Abrir men√∫"><i className="fas fa-bars text-xl"></i></button>
            </div>
          </div>
          {open && (
            <div className="md:hidden bg-slate-800/95 px-4 py-3 space-y-2">
              <a href="#home" onClick={()=>setOpen(false)} className="block">Inicio</a>
              <a href="#services" onClick={()=>setOpen(false)} className="block">Servicios</a>
              <a href="#catalog" onClick={()=>setOpen(false)} className="block">Productos</a>
              <a href="#contact" onClick={()=>setOpen(false)} className="block">Contacto</a>
              <button onClick={()=>{ setOpen(false); setPage('admin'); }} className="bg-brand-500 px-3 py-1 rounded">Admin</button>
            </div>
          )}
        </nav>
      );
    }

    // ---------- HERO ----------
    function Hero(){
      return (
        <section id="home" className="hero-bg h-80 md:h-96 flex flex-col items-center justify-center text-center px-4">
          <h1 className="text-3xl md:text-5xl font-extrabold text-white drop-shadow">Farmacia Virgen de los Remedios</h1>
          <p className="mt-3 text-lg text-slate-100/90">Tu salud, nuestro compromiso en Cuevo.</p>
        </section>
      );
    }

    // ---------- INFO ----------
    function Info(){
      return (
        <section className="py-12 px-6 max-w-6xl mx-auto">
          <h2 className="text-2xl md:text-3xl font-bold text-center text-brand-400 mb-8">Informaci√≥n General</h2>
          <div className="grid md:grid-cols-4 gap-6">
            <Card icon="fa-map-marker-alt" title="Ubicaci√≥n">Calle Sucre, entre Bol√≠var y 6 de Agosto, Cuevo</Card>
            <Card icon="fa-user-nurse" title="Farmac√©utica responsable">Lic. Lenni Escudero Andrade</Card>
            <Card icon="fa-clock" title="Horarios">Mediod√≠a: 12:00‚Äì15:00<br/>Noches: desde 19:00<br/>Fines de semana</Card>
            <Card icon="fa-whatsapp" title="Contacto">WhatsApp: +591 71317450</Card>
          </div>
        </section>
      );
    }

    function Card({icon, title, children}){
      return (
        <div className="bg-slate-900 p-5 rounded-2xl shadow hover:shadow-lg transition">
          <div className="flex items-start gap-3">
            <div className="p-3 bg-slate-800 rounded-lg"><i className={`fas ${icon} text-brand-400 text-2xl`}></i></div>
            <div>
              <h3 className="font-semibold">{title}</h3>
              <p className="text-slate-300 text-sm" dangerouslySetInnerHTML={{__html: String(children)}}/>
            </div>
          </div>
        </div>
      );
    }

    // ---------- SERVICIOS ----------
    function Servicios(){
      const items = [
        { icon: 'fa-pills', title: 'Venta de Medicamentos', desc: 'Gen√©ricos y de marca a tu alcance.' },
        { icon: 'fa-user-md', title: 'Asesoramiento', desc: 'Consulta con nuestra profesional.' },
        { icon: 'fa-truck', title: 'Delivery', desc: 'Coordinamos env√≠os locales (seg√∫n disponibilidad).' }
      ];
      return (
        <section id="services" className="py-12 px-6 bg-slate-800/10">
          <h2 className="text-2xl font-bold text-center mb-8 text-brand-400">Nuestros Servicios</h2>
          <div className="max-w-5xl mx-auto grid md:grid-cols-3 gap-6">
            {items.map((s,i)=> (
              <div key={i} className="bg-slate-900 p-6 rounded-2xl text-center shadow hover:shadow-lg">
                <i className={`fas ${s.icon} text-brand-400 text-4xl mb-4`}></i>
                <h3 className="font-semibold mb-2">{s.title}</h3>
                <p className="text-slate-300 text-sm">{s.desc}</p>
              </div>
            ))}
          </div>
        </section>
      );
    }

    // ---------- TARJETA PRODUCTO ----------
    function ProductoCard({product, onAdd, onDelete}){
      const src = product.img && typeof product.img === 'string' && product.img.length>0 ? product.img : 'https://images.unsplash.com/photo-1582719478250-c89cae4dc85b?auto=format&fit=crop&w=800&q=60';
      const [loaded, setLoaded] = useState(false);
      return (
        <div className="bg-slate-900 rounded-2xl overflow-hidden shadow hover:shadow-lg hover:-translate-y-1 transition">
          <div className={`w-full h-44 ${loaded? '':'animate-pulse bg-slate-800'}`}></div>
          <img loading="lazy" src={src} alt={product.nombre} className="w-full product-img -mt-44" onLoad={()=>setLoaded(true)} />
          <div className="p-4">
            <h3 className="font-bold text-lg mb-1 line-clamp-1">{product.nombre}</h3>
            <p className="text-sm text-slate-400 mb-1">Marca: {product.marca||'‚Äî'}</p>
            <p className="text-sm text-slate-400 mb-2 line-clamp-2">{product.uso||'‚Äî'}</p>
            <p className="text-brand-400 font-bold text-lg mb-3">{currency(product.precio)}</p>
            <div className="flex items-center gap-2">
              <button onClick={onAdd} className="flex-1 bg-brand-500 hover:bg-brand-600 text-white px-4 py-2 rounded-full text-sm flex items-center justify-center gap-2" aria-label={`Agregar ${product.nombre} al carrito`}>
                <i className="fas fa-cart-plus"></i> Agregar
              </button>
              {onDelete && <button onClick={onDelete} className="bg-red-500 hover:bg-red-600 text-white px-3 py-2 rounded-full text-sm">Borrar</button>}
            </div>
          </div>
        </div>
      );
    }

    // ---------- CAT√ÅLOGO ----------
    function Catalogo({productos = [], onAddToCart, toast}){
      const [filtro, setFiltro] = useState('todos');
      const [q, setQ] = useState('');
      const [orden, setOrden] = useState('relevancia');
      const [page, setPage] = useState(1);
      const porPagina = 12;
      const categorias = ['todos','medicamentos','bebes','cuidado'];

      const filtrados = useMemo(()=>{
        const term = q.trim().toLowerCase();
        let list = productos.filter(p => {
          const byCat = filtro==='todos' || p.categoria===filtro;
          const byTerm = !term || p.nombre.toLowerCase().includes(term) || (p.marca||'').toLowerCase().includes(term) || (p.uso||'').toLowerCase().includes(term);
          return byCat && byTerm;
        });
        if(orden==='precio-asc') list = [...list].sort((a,b)=> (a.precio||0)-(b.precio||0));
        if(orden==='precio-desc') list = [...list].sort((a,b)=> (b.precio||0)-(a.precio||0));
        if(orden==='nombre-az') list = [...list].sort((a,b)=> String(a.nombre).localeCompare(String(b.nombre)));
        return list;
      }, [productos, filtro, q, orden]);

      const totalPaginas = Math.max(1, Math.ceil(filtrados.length/porPagina));
      const vista = filtrados.slice((page-1)*porPagina, page*porPagina);
      useEffect(()=>{ setPage(1); }, [filtro, q, orden]);

      return (
        <section id="catalog" className="py-16 px-6">
          <h2 className="text-3xl font-bold text-center mb-8 text-brand-400">Cat√°logo de Productos</h2>

          <div className="max-w-5xl mx-auto mb-6 grid md:grid-cols-[1fr_auto_auto] gap-3 items-center">
            <div className="flex items-center bg-slate-800 rounded-xl overflow-hidden ring-1 ring-slate-700">
              <i className="fas fa-search px-3 text-slate-400" aria-hidden="true"></i>
              <input value={q} onChange={e=>setQ(e.target.value)} placeholder="Buscar producto, marca o uso..." className="flex-1 px-3 py-2 bg-transparent focus:outline-none" />
              {q && <button onClick={()=>setQ('')} className="px-3 text-slate-400 hover:text-white" aria-label="Limpiar b√∫squeda"><i className="fas fa-times"></i></button>}
            </div>
            <select value={orden} onChange={e=>setOrden(e.target.value)} className="px-3 py-2 bg-slate-800 rounded-xl ring-1 ring-slate-700">
              <option value="relevancia">Ordenar: Relevancia</option>
              <option value="precio-asc">Precio: menor a mayor</option>
              <option value="precio-desc">Precio: mayor a menor</option>
              <option value="nombre-az">Nombre: A ‚Üí Z</option>
            </select>
            <div className="flex gap-2 justify-end">
              {categorias.map(c=> (
                <button key={c} onClick={()=>setFiltro(c)} className={`px-3 py-2 rounded-lg transition border text-sm ${filtro===c? 'bg-brand-500 border-brand-500' : 'bg-slate-800 border-slate-700 hover:bg-slate-700'}`}>
                  {c==='todos'? 'Todos' : c==='medicamentos'? 'Medicamentos' : c==='bebes'? 'Beb√©s' : 'Cuidado'}
                </button>
              ))}
            </div>
          </div>

          <div className="grid sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-6">
            {vista.length ? vista.map((p,i)=> (
              <ProductoCard key={`${p.nombre}-${i}`} product={p} onAdd={()=>{ onAddToCart(p); toast.show('Agregado al carrito'); }} />
            )) : (
              <p className="col-span-full text-center text-slate-400">No se encontraron productos</p>
            )}
          </div>

          {totalPaginas>1 && (
            <div className="flex items-center justify-center gap-2 mt-8">
              <button disabled={page===1} onClick={()=>setPage(p=>Math.max(1,p-1))} className="px-3 py-2 rounded-lg bg-slate-800 disabled:opacity-50">Anterior</button>
              <span className="text-slate-400 text-sm">P√°gina {page} de {totalPaginas}</span>
              <button disabled={page===totalPaginas} onClick={()=>setPage(p=>Math.min(totalPaginas,p+1))} className="px-3 py-2 rounded-lg bg-slate-800 disabled:opacity-50">Siguiente</button>
            </div>
          )}
        </section>
      );
    }

    // ---------- CARRITO (DRAWER) ----------
    function CartDrawer({open, cart, setCart, onClose}){
      const total = cart.reduce((s,i)=> s + (i.precio*(i.cant||1)), 0);
      const sendWhatsApp = ()=>{
        if(cart.length===0) return;
        const lines = cart.map(i=> `‚Ä¢ ${i.cant||1} x ${i.nombre}${i.marca? ' ('+i.marca+')':''} ‚Äî ${currency(i.precio*(i.cant||1))}`);
        const msg = `Hola! Quiero realizar este pedido:%0A%0A${encodeURIComponent(lines.join('%0A'))}%0A%0A*Total:* ${encodeURIComponent(currency(total))}%0A%0A¬øPodr√≠an confirmarme stock?`;
        window.open(`https://wa.me/${PHONE_WHATSAPP}?text=${msg}`,'_blank');
      };
      const inc = (key)=> setCart(prev=> prev.map(i=> i.key===key? {...i, cant:(i.cant||1)+1} : i));
      const dec = (key)=> setCart(prev=> prev.map(i=> i.key===key? {...i, cant: Math.max(1,(i.cant||1)-1)} : i));
      const remove = (key)=> setCart(prev=> prev.filter(i=> i.key!==key));
      const clear = ()=> setCart([]);

      return (
        <div className={`fixed inset-0 z-50 flex ${open? '':'pointer-events-none'}`} aria-hidden={!open}>
          <div className={`flex-1 bg-black/50 transition-opacity ${open? 'opacity-100' : 'opacity-0'}`} onClick={onClose}></div>
          <aside className={`cart-drawer bg-slate-900 w-80 max-w-full h-full shadow-2xl flex flex-col ${open? 'cart-open':'cart-closed'}`} aria-label="Carrito de compras">
            <div className="p-4 border-b border-slate-800 flex justify-between items-center">
              <h3 className="font-bold text-lg">Tu carrito</h3>
              <button onClick={onClose} className="p-2" aria-label="Cerrar carrito"><i className="fas fa-times"></i></button>
            </div>
            <div className="p-4 flex-1 overflow-auto space-y-3">
              {cart.length===0 && <p className="text-slate-400">A√∫n no agregaste productos.</p>}
              {cart.map(item=> (
                <div key={item.key} className="flex items-center gap-3 bg-slate-800 p-2 rounded-lg">
                  <img loading="lazy" src={item.img||'https://images.unsplash.com/photo-1582719478250-c89cae4dc85b?auto=format&fit=crop&w=800&q=60'} className="w-12 h-12 object-cover rounded" alt=""/>
                  <div className="flex-1">
                    <p className="font-semibold text-sm leading-tight line-clamp-1">{item.nombre}</p>
                    <p className="text-xs text-slate-400">{currency(item.precio)}</p>
                    <div className="flex items-center gap-2 mt-1">
                      <button onClick={()=>dec(item.key)} className="px-2 py-0.5 bg-slate-700 rounded" aria-label="Disminuir">-</button>
                      <span>{item.cant||1}</span>
                      <button onClick={()=>inc(item.key)} className="px-2 py-0.5 bg-slate-700 rounded" aria-label="Aumentar">+</button>
                    </div>
                  </div>
                  <button onClick={()=>remove(item.key)} className="text-red-400" aria-label="Eliminar"><i className="fas fa-trash"></i></button>
                </div>
              ))}
            </div>
            <div className="p-4 border-t border-slate-800">
              <div className="flex items-center justify-between mb-3">
                <span className="font-bold">Total</span>
                <strong className="text-brand-400">{currency(total)}</strong>
              </div>
              <div className="flex gap-2">
                <button onClick={clear} className="flex-1 bg-slate-800 hover:bg-slate-700 px-4 py-2 rounded-lg">Vaciar</button>
                <button onClick={sendWhatsApp} className="flex-1 bg-brand-500 hover:bg-brand-600 px-4 py-2 rounded-lg font-semibold flex items-center justify-center gap-2">
                  <i className="fab fa-whatsapp"></i> Finalizar
                </button>
              </div>
            </div>
          </aside>
        </div>
      );
    }

    // ---------- ADMIN LOGIN ----------
    function AdminLogin({onSuccess}){
      const [user, setUser] = useState('');
      const [pass, setPass] = useState('');
      const tryLogin = (e)=>{
        e.preventDefault();
        const OK_USER = 'admin';
        const OK_PASS = 'farmacia2025';
        if(user===OK_USER && pass===OK_PASS){ sessionStorage.setItem('auth_admin','1'); onSuccess(); }
        else alert('Credenciales incorrectas');
      };
      return (
        <div className="min-h-[60vh] flex items-center justify-center p-6">
          <form onSubmit={tryLogin} className="w-full max-w-sm bg-slate-900 border border-slate-800 rounded-2xl p-6 shadow">
            <div className="flex items-center gap-3 mb-4"><i className="fas fa-shield-alt text-2xl text-brand-400"></i><h2 className="text-2xl font-bold">Acceso Administrativo</h2></div>
            <label className="block text-sm mb-1 text-slate-300">Usuario</label>
            <input className="w-full p-2 rounded text-black mb-3" value={user} onChange={e=>setUser(e.target.value)} placeholder="admin" />
            <label className="block text-sm mb-1 text-slate-300">Contrase√±a</label>
            <input type="password" className="w-full p-2 rounded text-black mb-4" value={pass} onChange={e=>setPass(e.target.value)} placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢" />
            <button type="submit" className="w-full bg-brand-500 hover:bg-brand-600 py-2 rounded font-semibold">Entrar</button>
            <p className="text-xs text-slate-400 mt-3">Consejo: cambia estas credenciales si vas a publicar el sitio.</p>
          </form>
        </div>
      );
    }

    // ---------- ADMIN PANEL ----------
    function AdminPanel({productos, setProductos, setPage}){
      const [editingIndex, setEditingIndex] = useState(null);
      const [form, setForm] = useState({ img:'', nombre:'', marca:'', uso:'', precio:'', categoria:'medicamentos' });

      useEffect(()=>{
        if(editingIndex!==null){
          const p = productos[editingIndex];
          if(p) setForm({ ...p, precio: String(p.precio||0) });
        }
      }, [editingIndex]);

      const handleChange = (e)=> setForm({...form, [e.target.name]: e.target.value});
      const handleFile = (e)=>{
        const f = e.target.files && e.target.files[0]; if(!f) return;
        const reader = new FileReader(); reader.onload = (ev)=> setForm(prev=> ({ ...prev, img: ev.target.result })); reader.readAsDataURL(f);
      };

      const addProduct = ()=>{
        if(!form.nombre || !form.precio) return alert('Nombre y precio son obligatorios');
        const nuevo = { ...form, precio: Number(form.precio)||0 };
        setProductos(prev=> [...prev, nuevo]);
        setForm({ img:'', nombre:'', marca:'', uso:'', precio:'', categoria:'medicamentos' });
      };
      const startEdit = (i)=> setEditingIndex(i);
      const saveEdit = ()=>{ if(editingIndex===null) return; setProductos(prev=> prev.map((it,idx)=> idx===editingIndex? { ...form, precio: Number(form.precio)||0 } : it )); setEditingIndex(null); setForm({ img:'', nombre:'', marca:'', uso:'', precio:'', categoria:'medicamentos' }); };
      const cancelEdit = ()=>{ setEditingIndex(null); setForm({ img:'', nombre:'', marca:'', uso:'', precio:'', categoria:'medicamentos' }); };
      const deleteProduct = (i)=>{ if(confirm('¬øEliminar este producto?')) setProductos(prev=> prev.filter((_,idx)=> idx!==i)); };

      return (
        <div className="p-6 max-w-7xl mx-auto">
          <div className="flex items-center justify-between mb-6">
            <h2 className="text-3xl font-bold text-brand-400">Panel Administrativo</h2>
            <div className="flex gap-2">
              <button onClick={()=> setPage('home')} className="bg-slate-800 px-3 py-1 rounded">Volver</button>
              <button onClick={()=>{ sessionStorage.removeItem('auth_admin'); location.reload(); }} className="bg-amber-500 px-3 py-1 rounded">Cerrar sesi√≥n</button>
            </div>
          </div>

          <div className="grid md:grid-cols-2 gap-6">
            <div className="bg-slate-900 p-4 rounded-2xl border border-slate-800">
              <h3 className="font-bold mb-3">{editingIndex!==null? 'Editar Producto':'Agregar Producto'}</h3>
              <div className="grid gap-2">
                <input name="img" value={(typeof form.img==='string' && form.img.startsWith('data:'))?'' : form.img} onChange={handleChange} placeholder="URL de Imagen (opcional)" className="w-full p-2 rounded text-black" />
                <input type="file" accept="image/*" onChange={handleFile} className="w-full p-2 rounded bg-slate-800 text-sm text-slate-300" />
                <input name="nombre" value={form.nombre} onChange={handleChange} placeholder="Nombre" className="w-full p-2 rounded text-black" />
                <input name="marca" value={form.marca} onChange={handleChange} placeholder="Marca" className="w-full p-2 rounded text-black" />
                <input name="uso" value={form.uso} onChange={handleChange} placeholder="Uso" className="w-full p-2 rounded text-black" />
                <input name="precio" value={form.precio} onChange={handleChange} placeholder="Precio (ej: 8.50)" className="w-full p-2 rounded text-black" />
                <select name="categoria" value={form.categoria} onChange={handleChange} className="w-full p-2 rounded text-black">
                  <option value="medicamentos">Medicamentos</option>
                  <option value="bebes">Beb√©s</option>
                  <option value="cuidado">Cuidado Personal</option>
                </select>

                <div className="flex gap-2 pt-2">
                  {editingIndex!==null ? (
                    <>
                      <button onClick={saveEdit} className="bg-brand-500 px-4 py-2 rounded">Guardar</button>
                      <button onClick={cancelEdit} className="bg-slate-700 px-4 py-2 rounded">Cancelar</button>
                    </>
                  ) : (
                    <button onClick={addProduct} className="bg-brand-500 px-4 py-2 rounded">Agregar</button>
                  )}
                </div>
              </div>
            </div>

            <div className="bg-slate-900 p-4 rounded-2xl border border-slate-800">
              <h3 className="font-bold mb-3">Inventario Actual</h3>
              <div className="grid sm:grid-cols-2 lg:grid-cols-3 gap-4">
                {productos.map((p,i)=> (
                  <div key={i} className="bg-slate-800 rounded-xl overflow-hidden">
                    <img loading="lazy" src={p.img||'https://images.unsplash.com/photo-1582719478250-c89cae4dc85b?auto=format&fit=crop&w=800&q=60'} className="w-full h-28 object-cover" alt="" />
                    <div className="p-3">
                      <p className="font-semibold line-clamp-1">{p.nombre}</p>
                      <p className="text-xs text-slate-400">{p.marca||'‚Äî'}</p>
                      <p className="text-brand-400 text-sm">{currency(p.precio)}</p>
                      <div className="flex gap-2 mt-2">
                        <button onClick={()=>startEdit(i)} className="flex-1 bg-amber-500 hover:bg-amber-600 px-2 py-1 rounded text-sm">Editar</button>
                        <button onClick={()=>deleteProduct(i)} className="flex-1 bg-red-500 hover:bg-red-600 px-2 py-1 rounded text-sm">Borrar</button>
                      </div>
                    </div>
                  </div>
                ))}
              </div>
            </div>
          </div>
        </div>
      );
    }

    // ---------- FOOTER ----------
    function Footer(){
      return (
        <footer id="contact" className="bg-slate-950 text-slate-400 py-10 mt-10 border-t border-slate-800">
          <div className="max-w-7xl mx-auto px-6 grid md:grid-cols-3 gap-8">
            <div>
              <h3 className="text-white font-bold mb-3">Virgen de los Remedios</h3>
              <p>Comprometidos con tu salud desde 2024. Servicio de confianza en Cuevo.</p>
            </div>
            <div>
              <h3 className="text-white font-bold mb-3">Enlaces</h3>
              <ul className="space-y-2">
                <li><a href="#home" className="hover:text-brand-400">Inicio</a></li>
                <li><a href="#services" className="hover:text-brand-400">Servicios</a></li>
                <li><a href="#catalog" className="hover:text-brand-400">Productos</a></li>
                <li><a href="#contact" className="hover:text-brand-400">Contacto</a></li>
              </ul>
            </div>
            <div>
              <h3 className="text-white font-bold mb-3">Contacto</h3>
              <p><strong>WhatsApp:</strong> +591 71317450</p>
              <p><strong>Email:</strong> info@virgendelosremedios.com</p>
            </div>
          </div>
          <div className="text-center text-sm mt-8 text-slate-500">&copy; 2025 Farmacia Virgen de los Remedios. Todos los derechos reservados.</div>
        </footer>
      );
    }

    // ---------- FAB BOT√ìN WHATSAPP + IR ARRIBA ----------
    function FloatingActions(){
      const [showTop, setShowTop] = useState(false);
      useEffect(()=>{
        const onScroll = ()=> setShowTop(window.scrollY>400);
        window.addEventListener('scroll', onScroll);
        return ()=> window.removeEventListener('scroll', onScroll);
      },[]);
      return (
        <div className="fixed bottom-5 right-5 z-40 flex flex-col gap-3">
          <a href={`https://wa.me/${PHONE_WHATSAPP}`} target="_blank" rel="noreferrer" className="w-12 h-12 rounded-full bg-brand-500 hover:bg-brand-600 grid place-items-center shadow-soft" aria-label="WhatsApp">
            <i className="fab fa-whatsapp text-2xl text-white"></i>
          </a>
          {showTop && (
            <button onClick={()=>window.scrollTo({top:0,behavior:'smooth'})} className="w-12 h-12 rounded-full bg-slate-800 hover:bg-slate-700 grid place-items-center border border-slate-700" aria-label="Subir">
              <i className="fas fa-arrow-up"></i>
            </button>
          )}
        </div>
      );
    }

    // ---------- APP ----------
    function App(){
      const toast = useToast();
      const [page, setPage] = useState('home');
      const [productos, setProductos] = useState(()=>{
        const raw = localStorage.getItem('productos'); if(raw) try{ return JSON.parse(raw); } catch(e){}
        return [
          {img:"imagenes/paracetamol500.jpg", nombre:"Paracetamol 500mg", marca:"Genfar", uso:"Analg√©sico / Antifebril", precio:6.00, categoria:"medicamentos"},
          {img:"imagenes/ibu400.jpg", nombre:"Ibuprofeno 400mg", marca:"Advil", uso:"Antiinflamatorio", precio:8.50, categoria:"medicamentos"},
          {img:"imagenes/amoxi500.jpg", nombre:"Amoxicilina 500mg", marca:"MK", uso:"Antibi√≥tico", precio:12.99, categoria:"medicamentos"},
          {img:"imagenes/lora10.jpg", nombre:"Loratadina 10mg", marca:"Claritin", uso:"Antial√©rgico", precio:7.25, categoria:"medicamentos"},
          {img:"imagenes/ome20.jpg", nombre:"Omeprazol 20mg", marca:"Prilosec", uso:"Anti√°cido / Reflujo", precio:9.75, categoria:"medicamentos"},
          {img:"imagenes/ena10.jpg", nombre:"Enalapril 10mg", marca:"Normopres", uso:"Antihipertensivo", precio:11.50, categoria:"medicamentos"},
          {img:"imagenes/met850.jpg", nombre:"Metformina 850mg", marca:"Glucophage", uso:"Diabetes tipo 2", precio:13.99, categoria:"medicamentos"},
          {img:"imagenes/salbu.jpg", nombre:"Salbutamol 100mcg", marca:"Ventolin", uso:"Asma / Bronquitis", precio:10.25, categoria:"medicamentos"},
          {img:"imagenes/diclo50.jpg", nombre:"Diclofenaco 50mg", marca:"Voltaren", uso:"Dolor / Inflamaci√≥n", precio:8.99, categoria:"medicamentos"},
          {img:"imagenes/napro550.jpg", nombre:"Naproxeno 550mg", marca:"Flanax", uso:"Dolor / Fiebre", precio:7.75, categoria:"medicamentos"},
          {img:"imagenes/acetil200.jpg", nombre:"Acetilciste√≠na 200mg", marca:"Fluimucil", uso:"Mucol√≠tico / Tos", precio:9.50, categoria:"medicamentos"},
          {img:"imagenes/cetirizina.jpg", nombre:"Cetirizina 10mg", marca:"Zyrtec", uso:"Alergias", precio:6.50, categoria:"medicamentos"},
          {img:"imagenes/azitromicina.jpg", nombre:"Azitromicina 500mg", marca:"Zithromax", uso:"Antibi√≥tico", precio:15.00, categoria:"medicamentos"},
          {img:"imagenes/losartan.jpg", nombre:"Losart√°n 50mg", marca:"Cozaar", uso:"Presi√≥n arterial", precio:10.00, categoria:"medicamentos"},
          {img:"imagenes/prednisona.jpg", nombre:"Prednisona 5mg", marca:"Dacortin", uso:"Corticoide", precio:5.50, categoria:"medicamentos"},
          {img:"imagenes/furosemida.jpg", nombre:"Furosemida 40mg", marca:"Lasix", uso:"Diur√©tico", precio:6.75, categoria:"medicamentos"},
          {img:"imagenes/clonazepam.jpg", nombre:"Clonazepam 2mg", marca:"Rivotril", uso:"Ansiedad / Convulsiones", precio:12.00, categoria:"medicamentos"},
          {img:"imagenes/insulina.jpg", nombre:"Insulina", marca:"Humalog", uso:"Diabetes tipo 1", precio:35.00, categoria:"medicamentos"},
          {img:"imagenes/acetaminofen.jpg", nombre:"Acetaminof√©n 500mg", marca:"Tylenol", uso:"Dolor / Fiebre", precio:7.00, categoria:"medicamentos"},
          {img:"imagenes/ranitidina.jpg", nombre:"Ranitidina 150mg", marca:"Zantac", uso:"Acidez / √ölceras", precio:8.50, categoria:"medicamentos"},
          // Beb√©s
          {img:"imagenes/panal.jpg", nombre:"Pa√±ales Huggies", marca:"Huggies", uso:"Higiene de beb√©s", precio:85.00, categoria:"bebes"},
          {img:"imagenes/leche_infantil.jpg", nombre:"Leche Infantil NAN 1", marca:"Nestl√©", uso:"Alimentaci√≥n infantil", precio:120.00, categoria:"bebes"},
          {img:"imagenes/toallitas.jpg", nombre:"Toallitas h√∫medas Pampers", marca:"Pampers", uso:"Limpieza para beb√©s", precio:25.00, categoria:"bebes"},
          // Cuidado
          {img:"imagenes/shampoo.jpg", nombre:"Shampoo Anticaspa", marca:"Head & Shoulders", uso:"Cuidado del cabello", precio:35.00, categoria:"cuidado"},
          {img:"imagenes/pasta_dental.jpg", nombre:"Pasta Dental Colgate", marca:"Colgate", uso:"Higiene bucal", precio:15.00, categoria:"cuidado"},
          {img:"imagenes/jabon.jpg", nombre:"Jab√≥n Neutro", marca:"Dove", uso:"Cuidado de la piel", precio:10.00, categoria:"cuidado"},
        ];
      });

      const [cart, setCart] = useState(()=>{
        const raw = localStorage.getItem('cart'); if(raw) try{ return JSON.parse(raw); } catch(e){}
        return [];
      });
      const [cartOpen, setCartOpen] = useState(false);
      const [adminAuthed, setAdminAuthed] = useState(()=> sessionStorage.getItem('auth_admin')==='1');

      useEffect(()=>{ localStorage.setItem('productos', JSON.stringify(productos)); }, [productos]);
      useEffect(()=>{ localStorage.setItem('cart', JSON.stringify(cart)); }, [cart]);

      const addToCart = (p)=>{
        setCart(prev=>{
          const key = `${p.nombre}-${p.marca}-${p.precio}`;
          const exists = prev.find(i=> i.key===key);
          if(exists) return prev.map(i=> i.key===key? {...i, cant:(i.cant||1)+1} : i);
          return [...prev, { key, img:p.img, nombre:p.nombre, marca:p.marca, precio:Number(p.precio)||0, cant:1 }];
        });
        setCartOpen(true);
      };

      return (
        <div className="bg-[#0f172a] min-h-screen">
          <Navbar setPage={setPage} cartCount={cart.reduce((s,i)=> s + (i.cant||1),0)} onOpenCart={()=>setCartOpen(true)} />
          <CartDrawer cart={cart} setCart={setCart} open={cartOpen} onClose={()=>setCartOpen(false)} />
          <FloatingActions />
          <Toast open={toast.open} msg={toast.msg} />

          {page==='home' && (
            <>
              <Hero />
              <Info />
              <Servicios />
              <Catalogo productos={productos} onAddToCart={addToCart} toast={toast} />
              <Footer />
            </>
          )}

          {page==='admin' && (
            adminAuthed ? (
              <AdminPanel productos={productos} setProductos={setProductos} setPage={setPage} />
            ) : (
              <AdminLogin onSuccess={()=>{ sessionStorage.setItem('auth_admin','1'); setAdminAuthed(true); }} />
            )
          )}
        </div>
      );
    }

    // Montar
    try{
      ReactDOM.createRoot(document.getElementById('root')).render(<App/>);
    } catch(err){
      console.error(err);
      const el = document.getElementById('root');
      el.innerHTML = `<div style="padding:16px;margin:16px;border-radius:12px;background:#111827;color:#e5e7eb;border:1px solid #1f2937">Ocurri√≥ un error al cargar la app. Revisa la consola (F12). Si est√°s sin internet, los CDNs pueden fallar.</div>`;
    }
  </script>

  <!-- Datos estructurados para SEO LocalBusiness / Pharmacy -->
  <script type="application/ld+json">
  {
    "@context":"https://schema.org",
    "@type":"Pharmacy",
    "name":"Farmacia Virgen de los Remedios",
    "address":{
      "@type":"PostalAddress",
      "streetAddress":"Calle Sucre, entre Bol√≠var y 6 de Agosto",
      "addressLocality":"Cuevo",
      "addressRegion":"Santa Cruz",
      "addressCountry":"BO"
    },
    "telephone":"+59171317450",
    "image":"https://images.unsplash.com/photo-1614975470486-613b87ec6dcd?auto=format&fit=crop&w=1470&q=80",
    "openingHours":"Mo-Su 12:00-15:00,19:00-23:59"
  }
  </script>
</body>
</html>
